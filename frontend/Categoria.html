<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="autor" content="Hugo López">
    <meta name="description" content="Página de Inicio, de aquí se puede acceder a las secciones principales">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Archivo CSS-->
    <link href="Categoria.css" rel="stylesheet">
    <link href="RegistrarseUSUARIO.css" rel="stylesheet">

    <!--Fuentes de letras-->
    <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">

    
    <!--Favicon-->
    <link rel="icon" type="image/x-icon" href="./img/favicon.png">
    <title>Categorías - BiteFinder</title>
</head>

<body>
    <!-- Barra de navegacion -->
    <nav class="navbar navbar-expand-xl navbar-light" style="padding: 2rem; background-color: #d3e71a">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-toggler"
                aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbar-toggler">
                <a class="navbar-brand">
                    <img src="./img/favicon.png" width="100px" alt="Logo de BiteFinder">
                </a>
                <h1 class="navbar-titulo" style="font-family: 'Lobster'; font-size: 60px; position: absolute; left: 50%; transform: translateX(-50%); text-align: center;">
                    BiteFinder
                  </h1>
                <ul class="navbar-nav d-flex justify-content-center align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" style="font-family: 'Oswald'; font-size: 30px;"
                            href="Inicio.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <!-- Si clican en el llevará a la parte inferior de la página, a la seccion de contacto-->
                        <a class="nav-link" style="font-family: 'Oswald'; font-size: 30px;"
                            href="#contacto">Contacto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" style="font-family: 'Oswald'; font-size: 30px;" href="Home.html">Iniciar
                            Sesión</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="container-fluid hero-section"
    style="height: calc(40vh - 80px); display: flex; align-items: center; justify-content: center; text-align: center; position: relative; overflow: hidden;">
    <!-- Imagen de fondo con pseudo-elemento -->
    <div class="background-image"
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('./img/delicious-pizza-isolated-white.jpg'); background-size: cover; background-position: center;  filter: brightness(50%);">
    </div>
    <!-- Contenido por encima de la imagen de fondo -->
    <div class="row" style="position: relative; width: 100%; max-width: 1200px; margin: 0 auto;">
        <div class="col" style="color: rgb(255, 255, 255);">
            <!-- Caja con color que incluye a h2 -->
            <div class="caja-subtitulo">
                <h2 id="tituloCategoria" style="font-family: 'Oswald'; font-size: 36px;">¿Quieres #italiano?</h2>
            </div>
        </div>
    </div>
</section>

<!-- Sección de restaurantes -->
<section class="restaurantes">
    <div class="container">
        <h3 style="font-family: 'Oswald';color: white;"> <u>Estos son los mejores restaurantes para ti:</u></h3>
        <div class="restaurant-cards" id="restaurant-cards">
            <!-- Aquí se van a cargar los restaurantes dinámicamente -->
        </div>
    </div>
</section>




    <!-- Seccion de contacto -->
    <section id="contacto" class="contacto">
        <div class="contact-section">
            <div>
                <div class="icon">
                    <img src="img/correo.png" alt="Email">
                </div>
                <h3 style="font-family: 'Oswald'; font-size: 30px;">CONTÁCTANOS</h3>
                <p style="font-family: 'Oswald'; font-size: 20px;">Nuestro equipo está para ayudar</p>
                <a href="mailto:admin@BiteFinder.com"
                    style="font-family: 'Oswald'; font-size: 20px;">admin@BiteFinder.com</a>
            </div>
            <div>
                <div class="icon">
                    <img src="img/localizacion.png" alt="Oficina">
                </div>
                <h3 style="font-family: 'Oswald'; font-size: 30px;">OFICINA</h3>
                <p style="font-family: 'Oswald'; font-size: 20px;">Nuestras oficinas en caso de dudas</p>
                <p><a href="https://maps.google.com/?q=Avenida%20Paraíso%20nº14" target="_blank"
                        style="font-family: 'Oswald'; font-size: 20px;">Avenida Paraíso nº14</a>
                </p>
            </div>
            <div>
                <div class="icon">
                    <img src="img/telefono.png" alt="Teléfono">
                </div>
                <h3 style="font-family: 'Oswald'; font-size: 30px;">TELÉFONO</h3>
                <p style="font-family: 'Oswald'; font-size: 20px;">Lunes-Viernes de 8am a 5am</p>
                <a href="tel:+976675452" style="font-family: 'Oswald'; font-size: 20px;">+976 675 452</a>
            </div>
        </div>
    </section>

    <!-- <div class="footer">
        Texto de muestra. Cambiar por otro texto.
    </div> -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    //     // Función para obtener el valor del parámetro "categoria" desde la URL
    //     function obtenerCategoriaDesdeURL() {
    //         const params = new URLSearchParams(window.location.search);
    //         return params.get('categoria');
    //     }
      
    //     document.addEventListener('DOMContentLoaded', async () => {
    //         const categoria = obtenerCategoriaDesdeURL();
    //         if (!categoria) {
    //             console.error('No se encontró la categoría en la URL');
    //             return;
    //         }
      
    //         // Actualizar el título de la página con la categoría seleccionada
    //         document.getElementById('tituloCategoria').textContent = `¿Quieres #${categoria}?`;
      
    //         // Hacer una llamada al backend para obtener los restaurantes de esta categoría
    //         try {
    //             const response = await fetch(`http://localhost:3000/api/restaurantesPorCategoria?categoria=${encodeURIComponent(categoria)}`);
    //             const restaurantes = await response.json();
                
    //             const restaurantCards = document.getElementById('restaurant-cards');
    //             restaurantCards.innerHTML = '';  // Limpiar el contenido anterior
      
    //             restaurantes.forEach(restaurante => {
    //                 const card = document.createElement('div');
    //                 card.classList.add('restaurant-card');
                    
    //                 card.innerHTML = `
    //                     <img src="${restaurante.fotos}" alt="${restaurante.nombre}">
    //                     <div class="restaurant-info">
    //                         <h2 class="restaurant-name">${restaurante.nombre}</h2>
    //                         <p class="restaurant-description">${restaurante.descripcion}</p>
    //                         <a href="detallesRest.html?id=${restaurante.nombre}" class="restaurant-button">View Details</a>
    //                     </div>
    //                 `;
    //                 restaurantCards.appendChild(card);
    //             });

      
    //         } catch (error) {
    //             console.error('Error al obtener los restaurantes por categoría:', error);
    //         }
        
    //     });
    //     // Añadir el evento click para guardar el nombre del restaurante en sessionStorage
    //     document.querySelectorAll('.restaurant-button').forEach(button => {
    //     button.addEventListener('click', (event) => {
    //         event.preventDefault(); // Prevenir la navegación por defecto

    //         // Obtener el nombre del restaurante desde el atributo data-nombre
    //         const nombreRestaurante = event.target.getAttribute('data-nombre');

    //         // Guardar el nombre del restaurante en sessionStorage
    //         sessionStorage.setItem('selectedRestaurant', nombreRestaurante);
    //         console.log('mando:', sessionStorage.getItem('selectedRestaurant'));
    //         // Redirigir a la página de detalles
    //         window.location.href = 'detallesRest.html';
    //     });
    // });
    // Función para obtener el valor del parámetro "categoria" desde la URL
function obtenerCategoriaDesdeURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get('categoria');
}

document.addEventListener('DOMContentLoaded', async () => {
    const categoria = obtenerCategoriaDesdeURL();
    if (!categoria) {
        console.error('No se encontró la categoría en la URL');
        return;
    }

    // Actualizar el título de la página con la categoría seleccionada
    document.getElementById('tituloCategoria').textContent = `¿Quieres #${categoria}?`;

    // Hacer una llamada al backend para obtener los restaurantes de esta categoría
    try {
        const response = await fetch(`http://localhost:3000/api/restaurantesPorCategoria?categoria=${encodeURIComponent(categoria)}`);
        const restaurantes = await response.json();
        
        const restaurantCards = document.getElementById('restaurant-cards');
        restaurantCards.innerHTML = '';  // Limpiar el contenido anterior

        restaurantes.forEach(restaurante => {
            const card = document.createElement('div');
            card.classList.add('restaurant-card');
            
            // Generar el HTML para cada restaurante
            card.innerHTML = `
                <img src="${restaurante.fotos}" alt="${restaurante.nombre}">
                <div class="restaurant-info">
                    <h2 class="restaurant-name">${restaurante.nombre}</h2>
                    <p class="restaurant-description">${restaurante.descripcion}</p>
                    <a href="#" class="restaurant-button" data-nombre="${restaurante.nombre}">View Details</a>
                </div>
            `;
            restaurantCards.appendChild(card);
        });

        // Después de generar las tarjetas, añadir los eventos click a los botones
        document.querySelectorAll('.restaurant-button').forEach(button => {
            button.addEventListener('click', (event) => {
                event.preventDefault(); // Prevenir la navegación por defecto

                // Obtener el nombre del restaurante desde el atributo data-nombre
                const nombreRestaurante = event.target.getAttribute('data-nombre');

                // Guardar el nombre del restaurante en sessionStorage
                sessionStorage.setItem('selectedRestaurant', nombreRestaurante);
                console.log('mando:', sessionStorage.getItem('selectedRestaurant'));

                // Redirigir a la página de detalles
                window.location.href = 'detallesRest.html';
            });
        });

    } catch (error) {
        console.error('Error al obtener los restaurantes por categoría:', error);
    }
});
      </script>
</body>

</html>